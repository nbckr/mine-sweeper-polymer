<link rel="import" href="../bower_components/polymer/polymer.html"/>
<link rel="import" href="../bower_components/paper-material/paper-material.html"/>

<dom-module id="minesweeper-cell">

    <style>
        paper-material {
            width: 40px;
            height: 40px;
            display: inline-block;
            background: white;
            box-sizing: border-box;
            margin: 2px;
            padding: 6px;
            border-radius: 2px;
            text-align: center;
        }

        paper-material.blabla {
            background-color: yellow;
        }

        paper-material.surrounding-0 {
            background-color: #8bc34a;
        }
        paper-material.surrounding-1 {
            background-color: #ffeb3b;
        }
        paper-material.surrounding-2 {
            background-color: #ffc107;
        }
        paper-material.surrounding-3,
        paper-material.surrounding-4,
        paper-material.surrounding-5,
        paper-material.surrounding-6,
        paper-material.surrounding-7,
        paper-material.surrounding-8 {
            background-color: #ea7f3b;
        }
        paper-material.mine {
            background-color: #c0392b;
        }
    </style>

    <template>
        <paper-material
                elevation="1"
                animated
                on-click="_handleLeftClick"
                on-contextmenu="_handleRightClick"
                on-mouseover="_animateMouseover"
                on-mouseout="_animateMouseout">
            <span hidden="{{!cell.isRevealed}}">{{cell.surroundingMines}}</span>
        </paper-material>
    </template>

    <script>
        Polymer({

            is: 'minesweeper-cell',

            properties: {
                cell: {
                    type: Object,
                    notify: true
                }
            },

            ready: function() {
                this.$$('paper-material').className += this._computeClass();
            },

            _computeClass: function() {
                return "surrounding-" + this.cell.surroundingMines;
            },

            _handleLeftClick: function (event) {
                console.log('cell: left click');

                    this.fire('ajax-post', {
                        action: 'reveal',
                        row: this.cell.position.row,
                        col: this.cell.position.col
                    });
            },

            _handleRightClick: function (event) {
                console.log('cell: right click');
                this.fire('ajax-post', {
                    action: 'flag',
                    row: this.cell.position.row,
                    col: this.cell.position.col
                });
            },
            
            _animateMouseover: function () {
                this.$$('paper-material').elevation = 4;
            },

            _animateMouseout: function () {
                this.$$('paper-material').elevation = 1;
            }
        });
    </script>

</dom-module>